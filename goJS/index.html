<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

</head>
<body>
<div id="box" style="width: 100%;height: 600px">

</div>
<div id="menu" style="display: none;width: 200px;height: 200px;background-color: #00abef">

</div>
<script src="go.js"></script>
<script>

    function changeColor() {
        console.log(1)
    }
    var objGo = go.GraphObject.make;
    var myDiagram = objGo(go.Diagram, "box",
        {
            //模型图的中心位置所在坐标
            initialContentAlignment: go.Spot.Center,
            //允许用户操作图表的时候使用Ctrl-Z撤销和Ctrl-Y重做快捷键
            "undoManager.isEnabled": true,
            //不运行用户改变图表的规模
            allowZoom: false,
            //画布上面是否出现网格
            "grid.visible": true,
            //允许在画布上面双击的时候创建节点
            "clickCreatingTool.archetypeNodeData": { text: "Node" },
            //允许使用ctrl+c、ctrl+v复制粘贴
            "commandHandler.copiesTree": true,
            //允许使用delete键删除节点
            "commandHandler.deletesTree": true,
            // dragging for both move and copy
            "draggingTool.dragsTree": true,
        });



    // 定义一个简单的节点模板
    myDiagram.nodeTemplate =
        objGo(go.Node, "Auto",//横向布局的面板
            //节点淡蓝色背景
            {
                // background: "red",
                 width:155,
                mouseEnter: function (e, obj){
                    window.oncontextmenu=function(event){

                        var e = event || window.event;
                        console.log(e)
                        document.getElementById("menu").style.left=e.clientX+"px";
                        document.getElementById("menu").style.top=e.clientY+"px";
                        document.getElementById("menu").style.display="block";
                        return false;
                    }
                }
            },
            objGo(go.Shape,
                // "RoundedRectangle", //定义形状，这是圆角矩形
                { /* Shape的参数。宽高颜色等等*/
                    figure: "RoundedRectangle",
                    width: 150,
                    height: 40,
                    margin: 4,
                    fill: 'blue' },
                // 绑定 Shape.figure属性为Node.data.fig的值，Model对象可以通过Node.data.fig 获取和设置Shape.figure（修改形状）
                // new go.Binding("figure", "fig"),
                new go.Binding('fill', 'color')
            ),
            objGo(go.TextBlock,
                // "1111",  // 默认文本
                // 设置字体大小颜色以及边距
                {
                    margin: 2,
                    stroke: "red",
                    font: "bold 16px sans-serif"
                }
                    ,
                //绑定TextBlock.text 属性为Node.data.name的值，Model对象可以通过Node.data.name获取和设置TextBlock.text
                new go.Binding("text", "key"),
            ),
            {
                contextMenu:objGo(go.Adornment, "Vertical", ("ContextMenuButton",
                    objGo(go.TextBlock, "ChangeColor"),
                    {
                    click: changeColor
                    }
               )),
                mouseEnter: function (e, obj){
                    window.oncontextmenu=function(event){
                        var e = event || window.event;
                        document.getElementById("menu").style.left=e.clientX+"px";
                        document.getElementById("menu").style.top=e.clientY+"px";
                        document.getElementById("menu").style.display="block";
                        return false;
                    }
                }
            }
        );


    var myModel = objGo(go.Model);//创建Model对象
    // model中的数据每一个js对象都代表着一个相应的模型图中的元素
    myModel.nodeDataArray = [
        { key: "Alpha", color: "white", fig: "RoundedRectangle" },
        { key: "Beta", color: "white", fig: "Ellipse" },
        { key: "Gamma", color: "white", fig: "Hexagon" },
        { key: "Delta", color: "white", fig: "FramedRectangle" },
        { key: "Epsilon", color: "white", fig: "Cloud" },
        { key: "Zeta", color: "white", fig: "Procedure" }
    ];

    myModel.linkDataArray =
        [
            { from: "Alpha", to: "Beta" },
            { from: "Delta", to: "Zeta" }
        ];
    myDiagram.model = myModel; //将模型数据绑定到画布图上


</script>
</body>
</html>